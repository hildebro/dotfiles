monitor.alsa.rules = [
  {
    matches = [
      {
        node.name = "~alsa_output.*hdmi-stereo.*"
      }
    ],
    actions = {
      update-props = {
        # FORCE 16-BIT AUDIO
        # Most monitor DACs choke on 32-bit (S32LE). This fixes digital crackle.
        audio.format = "S16LE",

        # BUFFER SETTINGS
        # 1024 is the sweet spot for HDMI.
        node.latency = 1024/48000,
        api.alsa.period-size = 1024,
        api.alsa.headroom = 4096,
        
        # TIMING STABILITY
        # Prevents the "batch" processing that can cause jitter on some HDMI links
        api.alsa.disable-batch = true,
      }
    }
  }
]
